{% extends "base.html" %}
{% block title %}Super Admin - Usu√°rios{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}?v=1.0">
{% endblock %}
{% block content %}
<!-- Header -->
<div style="background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%); padding: 3rem 2rem; margin-bottom: 3rem; border: 3px solid var(--gold); border-radius: 4px;">
    <div style="max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;">
        <div>
            <div style="display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.3); padding: 0.5rem 1.5rem; border: 2px solid var(--gold); margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 2px;">
                <span style="font-size: 1.2rem;">‚ö°</span>
                <span style="color: var(--gold); font-weight: 700; font-size: 0.9rem;">SUPER ADMIN</span>
            </div>
            <h1 style="font-size: 2.5rem; font-weight: 800; color: var(--text-color); margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 2px;">Gerenciamento de Usu√°rios</h1>
            <p style="color: rgba(245, 245, 220, 0.7); font-size: 1.1rem;">Visualize todos os usu√°rios organizados por barbearia</p>
        </div>
        
        <div>
            <a href="{{ url_for('super_admin_dashboard') }}" style="display: flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.3); color: var(--text-color); padding: 1rem 1.5rem; border: 2px solid var(--gold-dark); text-decoration: none; font-weight: 600; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px;">
                <span style="font-size: 1.2rem;">üè†</span>
                Dashboard
            </a>
        </div>
    </div>
</div>

<!-- Usu√°rios por Barbearia -->
<div style="max-width: 1400px; margin: 0 auto; padding: 0 2rem 3rem;">
    {% for barbearia_nome, usuarios_lista in usuarios_organizados.items() %}
    <div style="margin-bottom: 3rem;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding: 1.5rem; background: var(--bg-dark); border: 2px solid var(--gold-dark); border-radius: 4px; border-left: 4px solid var(--gold);">
            <h2 style="display: flex; align-items: center; gap: 0.75rem; font-size: 1.75rem; font-weight: 700; color: var(--gold); text-transform: uppercase; letter-spacing: 1px; margin: 0;">
                {% if barbearia_nome == 'Sistema' %}
                <span style="font-size: 1.5rem;">‚ö°</span>
                {{ barbearia_nome }}
                {% else %}
                <span style="font-size: 1.5rem;">üè¢</span>
                {{ barbearia_nome }}
                {% endif %}
            </h2>
            <div style="display: flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.4); padding: 0.75rem 1.25rem; border: 2px solid var(--gold-dark); border-radius: 4px;">
                <span style="font-size: 1.25rem; font-weight: 700; color: var(--gold);">{{ usuarios_lista|length }}</span>
                <span style="color: rgba(245, 245, 220, 0.6); font-size: 0.9rem;">usu√°rio{{ 's' if usuarios_lista|length != 1 else '' }}</span>
            </div>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1.5rem;">
            {% for item in usuarios_lista %}
            {% set usuario = item.usuario %}
            {% set vinculos = item.vinculos %}
            <div style="background: var(--bg-dark); padding: 1.5rem; border: 2px solid var(--gold-dark); border-radius: 4px; transition: all 0.3s ease;" onmouseover="this.style.borderColor='var(--gold)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.borderColor='var(--gold-dark)'; this.style.transform='translateY(0)'">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.25rem;">
                    <div style="width: 3rem; height: 3rem; border-radius: 50%; background: rgba(255, 255, 255, 0.4); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; border: 2px solid var(--gold-dark);">
                        {% if usuario.tipo_conta == 'super_admin' %}‚ö°
                        {% elif vinculos and vinculos[0].role == 'admin' %}üõ°Ô∏è
                        {% elif vinculos and vinculos[0].role == 'barbeiro' %}‚úÇÔ∏è
                        {% else %}üë§{% endif %}
                    </div>
                    <div style="flex: 1;">
                        <h4 style="font-size: 1.125rem; font-weight: 700; color: var(--gold); margin-bottom: 0.25rem;">{{ usuario.nome }}</h4>
                        <div style="color: rgba(245, 245, 220, 0.6); font-size: 0.875rem;">{{ usuario.email }}</div>
                    </div>
                    <div style="font-size: 1.25rem;">
                        {{ 'üü¢' if usuario.ativo else 'üî¥' }}
                    </div>
                </div>
                
                <div style="margin-bottom: 1rem; border-top: 1px solid var(--gold-dark); padding-top: 1rem;">
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid rgba(245, 245, 220, 0.1);">
                        <span style="color: rgba(245, 245, 220, 0.6); font-size: 0.875rem; font-weight: 600;">ID:</span>
                        <span style="color: var(--text-color); font-size: 0.875rem;">{{ usuario.id }}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid rgba(245, 245, 220, 0.1);">
                        <span style="color: rgba(245, 245, 220, 0.6); font-size: 0.875rem; font-weight: 600;">Tipo:</span>
                        <span style="color: {% if usuario.tipo_conta == 'super_admin' %}#8b5cf6{% elif usuario.tipo_conta == 'admin_barbearia' %}#ef4444{% elif usuario.tipo_conta == 'barbeiro' %}#f59e0b{% else %}#06b6d4{% endif %}; font-size: 0.875rem; font-weight: 700;">{{ usuario.tipo_conta|replace('_', ' ')|title }}</span>
                    </div>
                    {% if usuario.telefone %}
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid rgba(245, 245, 220, 0.1);">
                        <span style="color: rgba(245, 245, 220, 0.6); font-size: 0.875rem; font-weight: 600;">Telefone:</span>
                        <span style="color: var(--text-color); font-size: 0.875rem;">{{ usuario.telefone | format_phone }}</span>
                    </div>
                    {% endif %}
                    <div style="display: flex; justify-content: space-between; padding: 0.5rem 0;">
                        <span style="color: rgba(245, 245, 220, 0.6); font-size: 0.875rem; font-weight: 600;">Cadastro:</span>
                        <span style="color: var(--text-color); font-size: 0.875rem;">{{ usuario.data_criacao.strftime('%d/%m/%Y') if usuario.data_criacao else 'N/A' }}</span>
                    </div>
                </div>
                
                {% if vinculos %}
                <div style="background: rgba(255, 255, 255, 0.3); padding: 1rem; border-radius: 4px; border: 1px solid var(--gold-dark);">
                    <div style="font-size: 0.875rem; font-weight: 600; color: rgba(245, 245, 220, 0.7); margin-bottom: 0.5rem;">Fun√ß√µes:</div>
                    <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                        {% for vinculo in vinculos %}
                        <div style="display: flex; align-items: center; gap: 0.375rem; padding: 0.375rem 0.75rem; border-radius: 4px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; background: {% if vinculo.role == 'admin' %}#ef4444{% elif vinculo.role == 'barbeiro' %}#f59e0b{% else %}#06b6d4{% endif %}; color: white;">
                            {% if vinculo.role == 'admin' %}üõ°Ô∏è
                            {% elif vinculo.role == 'barbeiro' %}‚úÇÔ∏è
                            {% else %}üë§{% endif %}
                            {{ vinculo.role|title }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
</div>

<style>
a[href]:hover {
    border-color: var(--gold) !important;
    background: rgba(139, 92, 246, 0.2) !important;
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    div[style*="display: flex"] {
        flex-direction: column !important;
    }
    
    div[style*="display: grid"] {
        grid-template-columns: 1fr !important;
    }
}
</style>
{% endblock %}